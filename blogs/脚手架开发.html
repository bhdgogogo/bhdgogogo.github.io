<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>我的脚手架seb-cli —— 开发记录 | Seb&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/bg_avatar.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.24f512b0.css" as="style"><link rel="preload" href="/assets/js/app.a113d251.js" as="script"><link rel="preload" href="/assets/js/3.4a4413e0.js" as="script"><link rel="preload" href="/assets/js/1.8710bd02.js" as="script"><link rel="preload" href="/assets/js/32.85e312a4.js" as="script"><link rel="prefetch" href="/assets/js/10.dcbe45e1.js"><link rel="prefetch" href="/assets/js/11.481adf03.js"><link rel="prefetch" href="/assets/js/12.96bd29e1.js"><link rel="prefetch" href="/assets/js/13.a3fc69ec.js"><link rel="prefetch" href="/assets/js/14.ddd201f7.js"><link rel="prefetch" href="/assets/js/15.828d5c93.js"><link rel="prefetch" href="/assets/js/16.8f70f8d9.js"><link rel="prefetch" href="/assets/js/17.c064a947.js"><link rel="prefetch" href="/assets/js/18.0edb8a7c.js"><link rel="prefetch" href="/assets/js/19.5b692119.js"><link rel="prefetch" href="/assets/js/20.06888fe8.js"><link rel="prefetch" href="/assets/js/21.2aa7fdd3.js"><link rel="prefetch" href="/assets/js/22.dad8884d.js"><link rel="prefetch" href="/assets/js/23.d90d7b5b.js"><link rel="prefetch" href="/assets/js/24.73ee33b9.js"><link rel="prefetch" href="/assets/js/25.01e6eb95.js"><link rel="prefetch" href="/assets/js/26.83f72769.js"><link rel="prefetch" href="/assets/js/27.65f2128e.js"><link rel="prefetch" href="/assets/js/28.37232b4f.js"><link rel="prefetch" href="/assets/js/29.b910acff.js"><link rel="prefetch" href="/assets/js/30.19467548.js"><link rel="prefetch" href="/assets/js/31.0947ab51.js"><link rel="prefetch" href="/assets/js/33.874a4f4d.js"><link rel="prefetch" href="/assets/js/34.fd1c75c9.js"><link rel="prefetch" href="/assets/js/35.3a2574a9.js"><link rel="prefetch" href="/assets/js/36.37d75ec4.js"><link rel="prefetch" href="/assets/js/37.41d122a3.js"><link rel="prefetch" href="/assets/js/38.b13fe61f.js"><link rel="prefetch" href="/assets/js/39.1d45814e.js"><link rel="prefetch" href="/assets/js/4.505c287f.js"><link rel="prefetch" href="/assets/js/40.1d4dbdc3.js"><link rel="prefetch" href="/assets/js/41.7aafff7c.js"><link rel="prefetch" href="/assets/js/42.8218fde7.js"><link rel="prefetch" href="/assets/js/43.826b9f93.js"><link rel="prefetch" href="/assets/js/44.52ef885f.js"><link rel="prefetch" href="/assets/js/45.a7be2ed3.js"><link rel="prefetch" href="/assets/js/46.9dea66ff.js"><link rel="prefetch" href="/assets/js/47.978e450f.js"><link rel="prefetch" href="/assets/js/48.a03446fa.js"><link rel="prefetch" href="/assets/js/49.e4f95723.js"><link rel="prefetch" href="/assets/js/5.decbbaab.js"><link rel="prefetch" href="/assets/js/50.90491e91.js"><link rel="prefetch" href="/assets/js/51.225bc8ff.js"><link rel="prefetch" href="/assets/js/52.ea7069dc.js"><link rel="prefetch" href="/assets/js/53.03577c4c.js"><link rel="prefetch" href="/assets/js/54.d2c1be35.js"><link rel="prefetch" href="/assets/js/55.eda7b4be.js"><link rel="prefetch" href="/assets/js/56.1078d28c.js"><link rel="prefetch" href="/assets/js/57.d7e595cb.js"><link rel="prefetch" href="/assets/js/58.e2bcf50b.js"><link rel="prefetch" href="/assets/js/59.ef7f1fb4.js"><link rel="prefetch" href="/assets/js/6.bc5a6090.js"><link rel="prefetch" href="/assets/js/60.cdad56de.js"><link rel="prefetch" href="/assets/js/61.11e59a1d.js"><link rel="prefetch" href="/assets/js/62.62635892.js"><link rel="prefetch" href="/assets/js/63.c915cf1c.js"><link rel="prefetch" href="/assets/js/64.624ac399.js"><link rel="prefetch" href="/assets/js/65.fb100272.js"><link rel="prefetch" href="/assets/js/66.65d6c7f2.js"><link rel="prefetch" href="/assets/js/67.671d6711.js"><link rel="prefetch" href="/assets/js/68.781edbb5.js"><link rel="prefetch" href="/assets/js/69.d98a2d15.js"><link rel="prefetch" href="/assets/js/7.197f4a03.js"><link rel="prefetch" href="/assets/js/70.a75b388e.js"><link rel="prefetch" href="/assets/js/71.3ea3d8a3.js"><link rel="prefetch" href="/assets/js/72.063ac50a.js"><link rel="prefetch" href="/assets/js/73.8d9a8218.js"><link rel="prefetch" href="/assets/js/74.711c7e5e.js"><link rel="prefetch" href="/assets/js/75.18c263b9.js"><link rel="prefetch" href="/assets/js/76.d7a406d9.js"><link rel="prefetch" href="/assets/js/77.c3102dc8.js"><link rel="prefetch" href="/assets/js/78.9ef4f418.js"><link rel="prefetch" href="/assets/js/79.0ac21d76.js"><link rel="prefetch" href="/assets/js/8.7f6b08ee.js"><link rel="prefetch" href="/assets/js/80.c5207afa.js"><link rel="prefetch" href="/assets/js/81.7a076c92.js"><link rel="prefetch" href="/assets/js/82.e25b802d.js"><link rel="prefetch" href="/assets/js/83.be9b0f4e.js"><link rel="prefetch" href="/assets/js/84.9ae7c1dd.js"><link rel="prefetch" href="/assets/js/85.d0aa7fe2.js"><link rel="prefetch" href="/assets/js/86.45186d51.js"><link rel="prefetch" href="/assets/js/87.17ccd7b0.js"><link rel="prefetch" href="/assets/js/88.1678e3a5.js"><link rel="prefetch" href="/assets/js/89.cb3b0fe9.js"><link rel="prefetch" href="/assets/js/9.8e2dfb49.js"><link rel="prefetch" href="/assets/js/90.04ba14a4.js"><link rel="prefetch" href="/assets/js/91.b6596c1c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.24f512b0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Seb's Blog</h3> <p class="description" data-v-59e6cb88></p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>Seb</span>
          
        <!---->
        2024
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/bg_avatar.png" alt="Seb's Blog" class="logo"> <span class="site-name">Seb's Blog</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/handbook/javascript判断对象类型.html" class="nav-link"><i class="iconfont reco-suggestion"></i>
  学习文档
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/ES6/" class="nav-link"><i class="undefined"></i>
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/categories/javascript/" class="nav-link"><i class="undefined"></i>
  javascript
</a></li><li class="dropdown-item"><!----> <a href="/categories/node/" class="nav-link"><i class="undefined"></i>
  node
</a></li><li class="dropdown-item"><!----> <a href="/categories/css/" class="nav-link"><i class="undefined"></i>
  css
</a></li><li class="dropdown-item"><!----> <a href="/categories/secret/" class="nav-link"><i class="undefined"></i>
  secret
</a></li><li class="dropdown-item"><!----> <a href="/categories/webpack/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/categories/vue/" class="nav-link"><i class="undefined"></i>
  vue
</a></li><li class="dropdown-item"><!----> <a href="/categories/python/" class="nav-link"><i class="undefined"></i>
  python
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      工具网站
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.w3school.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  W3school
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gist.github.com/rxaviers/7360908" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Markdown emoji
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.typescriptlang.org/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  TypeScript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Seb
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/bhdgogogo" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://bhdgogogo.github.io/leetcode" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  My_leetcode
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/4411689157540359" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-juejin"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="/my_avatar.png" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    Seb
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>74</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>40</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41><li class="social-item" data-v-1fad0c41><i class="iconfont reco-github" style="color:#67cc86;" data-v-1fad0c41></i></li><li class="social-item" data-v-1fad0c41><i class="iconfont reco-npm" style="color:#f8b26a;" data-v-1fad0c41></i></li></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/handbook/javascript判断对象类型.html" class="nav-link"><i class="iconfont reco-suggestion"></i>
  学习文档
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/ES6/" class="nav-link"><i class="undefined"></i>
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/categories/javascript/" class="nav-link"><i class="undefined"></i>
  javascript
</a></li><li class="dropdown-item"><!----> <a href="/categories/node/" class="nav-link"><i class="undefined"></i>
  node
</a></li><li class="dropdown-item"><!----> <a href="/categories/css/" class="nav-link"><i class="undefined"></i>
  css
</a></li><li class="dropdown-item"><!----> <a href="/categories/secret/" class="nav-link"><i class="undefined"></i>
  secret
</a></li><li class="dropdown-item"><!----> <a href="/categories/webpack/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/categories/vue/" class="nav-link"><i class="undefined"></i>
  vue
</a></li><li class="dropdown-item"><!----> <a href="/categories/python/" class="nav-link"><i class="undefined"></i>
  python
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      工具网站
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.w3school.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  W3school
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gist.github.com/rxaviers/7360908" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Markdown emoji
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.typescriptlang.org/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  TypeScript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      Seb
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/bhdgogogo" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://bhdgogogo.github.io/leetcode" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  My_leetcode
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/4411689157540359" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-juejin"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>我的脚手架seb-cli —— 开发记录</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>Seb</span>
          
        <!---->
        2024
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">我的脚手架seb-cli —— 开发记录</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>Seb</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2023/7/20</span></i> <i class="iconfont reco-eye" data-v-8a445198><span id="/blogs/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-8a445198><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <!----></div></div> <div class="theme-reco-content content__default"><div class="custom-block tip"><p class="title"></p><p>为什么要开发一个脚手架？</p> <p>因为有一个自己的脚手架真的是一件很酷的事情😉</p></div><h2 id="什么是脚手架"><a href="#什么是脚手架" class="header-anchor">#</a> ❓ 什么是脚手架</h2> <p>在开发之前，先说一下脚手架是什么，它有什么功能？</p> <p>简单来说，脚手架就是一个<strong>通过选择几个选项快速搭建项目基础代码的工具</strong></p> <p>在我看来，脚手架 <strong>最重要</strong> 的功能就是帮助你快速的把项目的基础架子搭好，比如项目依赖，模板，构建工具等等，<strong>让你不用从零开始自己手动配置一个项目，提升你的开发效率</strong>；同时，对于团队开发，可以保证团队项目管理的统一，比如文件目录架构，命名方式等等</p> <p>说的更直接一点，脚手架省去了你在创建项目时不断 <code>ctrl + c</code> 和 <code>ctrl + v</code>的不专业操作😂</p> <h2 id="准备工作"><a href="#准备工作" class="header-anchor">#</a> 准备工作</h2> <p>首先，要问一下自己，你想实现一个什么样效果的一个脚手架呢？</p> <p>我是想由简单到复杂，先实现如下的功能效果</p> <ol><li>用户输入命令，比如<code>xxx create &lt;your projectName&gt;</code>，开始创建项目</li> <li>脚手架解析用户命令，并弹出交互语句，询问用户创建项目需要哪些功能，比如要不要配置<code>eslint</code>这些</li> <li>用户选择你自己需要的功能</li> <li>脚手架根据游湖的选择创建<code>package.json</code>文件，并添加对应的依赖项</li> <li>脚手架根据用户的选择渲染项目模板，生成文件（例如 <code>index.html、main.js、App.vue</code>这些文件）</li> <li>执行命令安装依赖 —— 比如<code>yarn i</code></li></ol> <p>用到了一些插件👇</p> <ul><li><code>commander</code>: 自定义命名行命令</li> <li><code>inquirer</code>: 终端提示</li> <li><code>download-git-repo</code>: 克隆模板和<code>github</code>仓库</li> <li><code>ora: loading</code>的可视化</li> <li><code>chalk</code>: 彩色终端字体</li></ul> <h2 id="项目目录"><a href="#项目目录" class="header-anchor">#</a> 项目目录</h2> <p>为我们的脚手架建立一个文件夹，这里我就叫<code>seb-cli</code>了，关于每个文件的作用可以参考注释~</p> <div class="language-bash extra-class"><pre class="language-bash"><code>├─.vscode
├─bin
│  ├─mvc.js <span class="token comment"># mvc 全局命令</span>
├─lib
│  ├─generator <span class="token comment"># 各个功能的模板</span>
│  │  ├─babel <span class="token comment"># babel 模板</span>
│  │  ├─linter <span class="token comment"># eslint 模板</span>
│  │  ├─router <span class="token comment"># vue-router 模板</span>
│  │  ├─vue <span class="token comment"># vue 模板</span>
│  │  ├─vuex <span class="token comment"># vuex 模板</span>
│  │  └─webpack <span class="token comment"># webpack 模板</span>
│  ├─promptModules <span class="token comment"># 各个模块的交互提示语</span>
│  └─utils <span class="token comment"># 一系列工具函数</span>
│  ├─create.js <span class="token comment"># create 命令处理函数</span>
│  ├─Creator.js <span class="token comment"># 处理交互提示</span>
│  ├─Generator.js <span class="token comment"># 渲染模板</span>
│  ├─PromptModuleAPI.js <span class="token comment"># 将各个功能的提示语注入 Creator</span>
└─scripts <span class="token comment"># commit message 验证脚本 和项目无关 不需关注</span>
</code></pre></div><h2 id="开始开发"><a href="#开始开发" class="header-anchor">#</a> 开始开发</h2> <h3 id="最后一次开发前的准备"><a href="#最后一次开发前的准备" class="header-anchor">#</a> 最后一次开发前的准备</h3> <p>ps: 我保证这是最后一次准备了！，其实是一个<code>tips</code>，帮你解决一个问题，为什么我们输入命令后，文件会立即执行？</p> <p>直接拿一个例子来分析</p> <ol><li>首先建立一个<code>index.js</code>文件作为入口文件，我们要通过我们的命令来运行该文件</li> <li>命令行输入<code>yarn install y</code> 创建<code>package.json</code></li></ol> <p>只需要这两个文件，就能解决你的困惑 😅</p> <ol start="3"><li>在<code>index.js</code>的<strong>第一行</strong>写上这行代码 —— <strong>这行代码就可以让我们的<code>index.js</code>自动执行了</strong></li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/usr/bin/env node</span>
</code></pre></div><div class="custom-block tip"><p class="title"></p><p>这行代码叫做<code>shebang</code>或者<code>hashbang</code>，虽然可以写绝对路径但因为兼容性问题还是推荐上述这种写法</p> <p>注意不要写成<code>user</code>，虽然<code>usr</code>是<code>user</code>的缩写，但是写成<code>user</code>会报错嗷 ~ 💢</p></div><ol start="4"><li>要让终端能识别我们的命令，我们就要在 package.json 中配置上我们的命令</li></ol> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	...
  <span class="token property">&quot;bin&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;seb&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span>
  <span class="token punctuation">}</span>
  ...
<span class="token punctuation">}</span>
</code></pre></div><ol start="5"><li>命令行输入<code>npm link</code></li></ol> <div class="custom-block tip"><p class="title"></p><p>这一步的作用是让<code>package.json</code>里的这个<code>bin</code>和真正环境变量的<code>bin</code>链接，这样就能让我这个<code>seb</code>作为终端命令配置到环境变量中，现在你可以在电脑的任何地方使用<code>seb</code>了 —— 软链接</p></div><ol start="6"><li>随便在<code>index.js</code>里边写一点代码</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;dys up up&quot;</span><span class="token punctuation">)</span>；
</code></pre></div><ol start="7"><li>然后直接在控制台输入我们的命令<code>seb</code>，就可以输出<code>index.js</code>中的内容了~</li></ol> <p><img src="https://raw.githubusercontent.com/bhdgogogo/cloud-img/img/blogImg/20230720164823.png" alt="1"></p> <p>希望通过这样一个例子，你可以对命令跟文件的关系有一个新的认识，下面我们就开始脚手架的开发，这次是真的开始了！💥</p> <div class="custom-block tip"><p class="title"></p><p>需要注意的是，我们所有的内容都是CJS规范，但是有的库的高版本默认只支持EJS规范了，比如inquirer, chalk这些，所以我们应该安装这些库的较低版本</p> <p>如果你安装了高版本，就得基于<code>EJS</code>规范来编写了，我亲身经历，有的地方写起来非常痛苦😢，比如动态引入文件的地方，<code>EJS</code>和<code>CJS</code>异步任务执行顺序是有区别的，所以建议大家还是安装低版本的库吧~</p></div><h3 id="处理用户命令"><a href="#处理用户命令" class="header-anchor">#</a> <strong>处理用户命令</strong></h3> <p>脚手架的第一个功能是处理用户的命令，所以我们借助<code>commander</code>这个库，来帮助我们提取出用户在命令行输入的内容，并交给我们的脚手架</p> <p>直接上代码分析，先安装，在<code>bin</code>文件夹的<code>mvc.js</code>编写下面的代码</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">/</span>bin<span class="token operator">/</span>mvc<span class="token punctuation">.</span>js
<span class="token keyword">const</span> program <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;commander&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> create <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../lib/create&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

program
  <span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token string">&quot;0.1.0&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 设置脚手架的版本</span>
  <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&quot;create &lt;name&gt;&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 命令名称</span>
  <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;create your project&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 命令描述</span>
  <span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">create</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// name就是命令后边输入的参数</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

program<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 解析控制台输入的字符串</span>
</code></pre></div><p>现在我们就通过<code>commander</code>注册了一个命令 —— <code>create</code>，并配置了命令的基本信息，比如版本和描述</p> <p>然后的操作就可以参考我们最后一次准备的工作（这时就体现它的重要性了😄）</p> <p>配置<code>package.json</code>如下</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;bin&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;seb&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./bin/mvc.js&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>这里就相当于用<code>seb</code>命令来代替执行 —— <code>node ./bin/mvc.js</code></p> <p>比如我们在控制台输入<code>seb create demo</code>，实际上就是在执行<code>mvc.js</code>这个文件，<code>commander</code>解析到命令<code>create</code>和参数<code>demo</code>，然后可以在<code>action</code>的回调里获取到这个参数，比如上面代码里面的<code>name</code>的值就是<code>demo</code></p> <p>这样就实现了第一个功能，测试一下~</p> <p><img src="https://raw.githubusercontent.com/bhdgogogo/cloud-img/img/blogImg/20230720191643.png" alt="2"></p> <div class="custom-block danger"><p class="title"></p><p>在这里有一个地方要注意，在配置<code>mvc.js</code>时，有时会报下面这样的错误，这是<code>mvc.js</code>是带<code>BOM</code>编码的<code>UTF-8</code>文件，所以导致了这个问题</p> <p>删掉这一行就可以正常运行了，因为此时<code>start</code>命令已经指定了<code>node</code></p></div><p><img src="https://raw.githubusercontent.com/bhdgogogo/cloud-img/img/blogImg/20230720191742.png" alt="3"></p> <h3 id="与用户交互"><a href="#与用户交互" class="header-anchor">#</a> <strong>与用户交互</strong></h3> <p>获取到用户的命令行输入（要创建的项目名称 <code>demo</code>）之后，接下来脚手架要做的工作就是询问用户，要不要配置一些东西，比如<code>eslint, webpack</code>这些工具</p> <p>这时就要用到<code>Inquirer</code>这个库（<code>yarn add Inquirer</code>），主要功能就是在控制台弹出一些问题和选项，让用户选择，然后脚手架根据用户的选择来进行之后的操作</p> <p>首先看一下<code>Inquirer</code>是怎么实现交互的 —— 下面的代码不是我们脚手架的代码，只是帮助你来理解一些<code>Inquirer</code>的一些配置</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// test.js</span>
<span class="token keyword">const</span> inquirer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;inquirer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> prompts <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;features&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 选项名称</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;Check the features needed for your project:&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 选项提示语</span>
    <span class="token literal-property property">pageSize</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;checkbox&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 选项类型 另外还有 confirm list 等</span>
    <span class="token literal-property property">choices</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 具体的选项</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Babel&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 选项名称</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;babel&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 如果选择该选项，我们拿到的值</span>
        <span class="token literal-property property">short</span><span class="token operator">:</span> <span class="token string">&quot;Babel&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">description</span><span class="token operator">:</span>
          <span class="token string">&quot;Transpile modern JavaScript to older versions (for compatibility)&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">link</span><span class="token operator">:</span> <span class="token string">&quot;https://babeljs.io/&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">checked</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Router&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;router&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">&quot;Structure the app with dynamic pages&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">link</span><span class="token operator">:</span> <span class="token string">&quot;https://router.vuejs.org/&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span>prompts<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>运行这个文件 —— <code>node test.js</code>，控制台弹出的内容如下</p> <p><img src="https://raw.githubusercontent.com/bhdgogogo/cloud-img/img/blogImg/20230720195959.png" alt="4"></p> <p>首先看问题，内容就是我们配置的<code>message</code>，同时由于我们配置了问题是<code>checkbox</code>，所以是多选，我们可以同时选择两个选项，如果我们同时选择两个选项的话，控制台会显示下面的结果👇</p> <p><img src="https://raw.githubusercontent.com/bhdgogogo/cloud-img/img/blogImg/20230720200958.png" alt="5"></p> <p>在项目里，我们拿到的则是一个对象</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">features</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;babel&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;router&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其中 <code>features</code> 是上面配置的 <code>name</code> 属性。<code>features</code> 数组中的值就是每个选项中的 <code>value</code></p> <p>同时，<code>Inquirer</code>还可以提供具有相关性的问题，也就是当上一个问题选择了指定的选项时，下一个问题才会显示出来。例如下面的代码：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// const inquirer = require(&quot;inquirer&quot;);</span>
<span class="token keyword">const</span> inquirer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;inquirer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> chalk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;chalk&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> prompts <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;features&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 选项名称</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;Check the features needed for your project:&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 选项提示语</span>
    <span class="token literal-property property">pageSize</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;checkbox&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 选项类型 另外还有 confirm list 等</span>
    <span class="token literal-property property">choices</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 具体的选项</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Babel&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 选项名称</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;babel&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 选项在我们代码中对应的值</span>
        <span class="token literal-property property">short</span><span class="token operator">:</span> <span class="token string">&quot;Babel&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">description</span><span class="token operator">:</span>
          <span class="token string">&quot;Transpile modern JavaScript to older versions (for compatibility)&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">link</span><span class="token operator">:</span> <span class="token string">&quot;https://babeljs.io/&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">checked</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Router&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;router&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">&quot;Structure the app with dynamic pages&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">link</span><span class="token operator">:</span> <span class="token string">&quot;https://router.vuejs.org/&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;historyMode&quot;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">when</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">answers</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> answers<span class="token punctuation">.</span>features<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;confirm&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Use history mode for router? </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>chalk<span class="token punctuation">.</span><span class="token function">yellow</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">(Requires proper server setup for index fallback in production)</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">By using the HTML5 History API, the URLs don't need the '#' character anymore.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token literal-property property">link</span><span class="token operator">:</span> <span class="token string">&quot;https://router.vuejs.org/guide/essentials/history-mode.html&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span>prompts<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>重点就是<code>when</code>这个属性，它是一个函数，只有当他返回为真时，这个问题才会显示，这里只有当我们选择<code>Router</code>这个选项时，这个问题才会接着显示在控制台上面👇</p> <p><img src="https://raw.githubusercontent.com/bhdgogogo/cloud-img/img/blogImg/20230720202209.png" alt="6"></p> <p><img src="https://raw.githubusercontent.com/bhdgogogo/cloud-img/img/blogImg/20230720202237.png" alt="7"></p> <p>下面就开始我们的脚手架里<code>Inquirer</code>的配置了~</p> <ul><li>将对应的问题和可选值在控制台上展示出来，供用户选择</li> <li>当用户选择后，获取到用户具体的选项值后，再渲染模板和依赖</li></ul> <p>下面就开始添加<code>seb-cli</code>支持的功能了~</p> <p>因为我目前做的都是<code>vue</code>的项目，同时，项目离不开<code>webpack</code>（<code>vite</code>之后会考虑的~），所以我在这里是默认提供了<code>vue</code>和<code>webpack</code>的</p> <p>其他功能就可供用户选择了👇</p> <ul><li>vue-router</li> <li>vuex</li> <li>babel</li> <li>eslint</li></ul> <p>关于这四个功能的文件（以后想要添加其他的功能也是放到这里），我把它们放到了<code>lib/promptModules</code>目录下</p> <p>文件里边的内容跟我们刚才给的<code>Inquirer</code>示例是一样的，只是我们现在只需要<code>choices</code>属性里的部分了，比如<code>babel.js</code>👇</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">api</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    api<span class="token punctuation">.</span><span class="token function">injectFeature</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Babel'</span><span class="token punctuation">,</span>	<span class="token comment">// 选项名</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'babel'</span><span class="token punctuation">,</span>	<span class="token comment">// 值</span>
        <span class="token literal-property property">short</span><span class="token operator">:</span> <span class="token string">'Babel'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">'Transpile modern JavaScript to older versions (for compatibility)'</span><span class="token punctuation">,</span>	<span class="token comment">// 选项功能描述</span>
        <span class="token literal-property property">link</span><span class="token operator">:</span> <span class="token string">'https://babeljs.io/'</span><span class="token punctuation">,</span>	<span class="token comment">// 链接</span>
        <span class="token literal-property property">checked</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>		<span class="token comment">// 默认选择</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>此时<code>Babel</code>的功能选项就配置完了，其实就是一个问题，问一下用户用不用<code>babel</code>，下一步开始把这个选项注入到我们的问题中</p> <p>因为现在就是一个命令在操控 —— <code>seb create</code>，所以我们要添加<code>create</code>的内容了 —— 你可以把<code>create</code>当作是一个函数，它来帮我们创建这些问题，然后把这些功能的交互提示语都给整合到一起👇</p> <p><code>create.js</code>里的代码的逻辑如下：</p> <ol><li>创建<code>Creator</code> 的实例对象</li> <li>调用 <code>getPromptModules()</code> 获取所有功能的交互提示语</li> <li>再调用 <code>PromptModuleAPI</code>将所有交互提示语注入到 <code>creator</code> 对象</li> <li>通过 <code>const answers = await inquirer.prompt(creator.getFinalPrompts())</code>
在控制台弹出交互语句，并将用户选择结果赋值给 <code>answers</code> 变量。</li></ol> <p>在实现<code>create.js</code>之前，我们先分析一下其中用到的类</p> <p>第一步创建了 <code>creator</code>对象，所以我们要声明一个<code>Creator</code>的类，这个类其实很简单，我们根据它的功能来分析即可，它要<strong>接收功能的所有交互提示语，然后通过调用它的<code>get</code>方法来将这些交互语句返回</strong> ，就是这么简单，所以我们先把这个类给实现👇</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Creator.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">Creator</span> <span class="token punctuation">{</span>
  <span class="token function">constuctor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 存储所有功能对象 —— choices用来存储每个功能的属性</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>featruePrompt <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;features&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;请选择你要添加到你项目的功能~:&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">pageSize</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;checkbox&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">choices</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>injectPrompts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 用来存储每个功能注入的提示语</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 获取所有已经注入的功能交互提示语</span>
  <span class="token function">getFinalPrompts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 处理没有when的情况，如果输入的功能对象中没有when属性</span>
    <span class="token comment">// 就给它绑定一个when属性，它的值是一个返回true的回调函数</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>injectPrompts<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prompt</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> originWhen <span class="token operator">=</span> prompt<span class="token punctuation">.</span>when <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      prompt<span class="token punctuation">.</span><span class="token function-variable function">when</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">answer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">originWhen</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 将处理过的交互提示语和基本属性组合</span>
    <span class="token keyword">const</span> prompt <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>featruePrompt<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>injectPrompts<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> prompt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后就是<code>PromptModuleAPI</code>，也很简单，它的作用就是接收一个<code>Creator</code>实例，然后把功能对象的基本属性和它的交互提示语注入到<code>Creator</code>实例里👇</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">PromptModuleAPI</span> <span class="token punctuation">{</span>
  <span class="token comment">// 接收一个Creator对象</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">creator</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>creator <span class="token operator">=</span> creator<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 注入功能属性</span>
  <span class="token function">injectFeature</span><span class="token punctuation">(</span><span class="token parameter">feature</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>creator<span class="token punctuation">.</span>featurePrompt<span class="token punctuation">.</span>choices<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 注入功能交互提示语</span>
  <span class="token function">injectPrompt</span><span class="token punctuation">(</span><span class="token parameter">prompt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>creator<span class="token punctuation">.</span>injectPrompt<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>prompt<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>现在开始写<code>create.js</code>里的内容，其实很简单，这样我们的思路也就更清晰了~</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// create.js</span>
<span class="token keyword">const</span> Creator <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./Creator.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> PromptModuleAPI <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./PromptModuleAPI.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> inquirer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;inquirer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> creator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Creator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> clearConsole <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./utils/clearConsole.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 这个函数用来导入功能文件 —— 获取所有功能的交互提示语</span>
<span class="token keyword">const</span> <span class="token function-variable function">getPromptModules</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> allModules <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;babel&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;router&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vuex&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;eslint&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出功能模块接口的函数</span>
  <span class="token keyword">return</span> allModules<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./promptModules/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 获取每个功能的交互提示语和属性</span>
<span class="token keyword">const</span> promptModules <span class="token operator">=</span> <span class="token function">getPromptModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 把creator封装成PromptModuleAPI对象</span>
<span class="token keyword">const</span> promptAPI <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PromptModuleAPI</span><span class="token punctuation">(</span>creator<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 把每个功能的交互提示语注入到creator对象</span>
promptModules<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">myModule</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">myModule</span><span class="token punctuation">(</span>promptAPI<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 清空控制台</span>
<span class="token function">clearConsole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 拿到用户选择后的结果</span>
<span class="token comment">// const answers = await inquirer.prompt(creator.getFinalPrompts());</span>
inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span>creator<span class="token punctuation">.</span><span class="token function">getFinalPrompts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果用户选择了所有供选择的功能，我们来打印<code>answer</code>看一下👇</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token comment">// 现在添加的功能</span>
  <span class="token literal-property property">features</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'babel'</span><span class="token punctuation">,</span> <span class="token string">'router'</span><span class="token punctuation">,</span> <span class="token string">'vuex'</span><span class="token punctuation">,</span> <span class="token string">'linter'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// vue-router路由是否使用 history 模式</span>
  <span class="token literal-property property">historyMode</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// eslint 检验代码的默认规则，可以被覆盖</span>
  <span class="token literal-property property">eslintConfig</span><span class="token operator">:</span> <span class="token string">'standard'</span><span class="token punctuation">,</span>
  <span class="token comment">// 什么时候进行eslint校验，保存和提交时</span>
  <span class="token literal-property property">lintOn</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'save'</span><span class="token punctuation">,</span> <span class="token string">'commit'</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="项目模板"><a href="#项目模板" class="header-anchor">#</a> <strong>项目模板</strong></h3> <p>现在我们已经拿到用户的选择， 想一下我们在使用<code>vue-cli</code>或者其他脚手架时，在我们选完我们要的功能后，安装之后，选的内容最后是不是出现在<code>package.json</code>文件里了，所以我们这一步就要来生成和渲染对应的<code>package.json</code>文件了</p> <p>先看如何生成<code>package.json</code></p> <p>先定义一个 <code>pkg</code> 变量来表示 <code>package.json</code> 文件，并设定一些默认值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// create.js</span>
<span class="token keyword">const</span> pkg <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">,</span>
    <span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token string">'0.1.0'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">dependencies</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">devDependencies</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>关于每个功能对应的模板（包括<code>package.json</code>和要渲染的内容），都放在了<code>lib/generator</code> 目录下：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>├─lib
│  ├─generator <span class="token comment"># 各个功能的模板</span>
│  │  ├─babel <span class="token comment"># babel 模板</span>
│  │  ├─linter <span class="token comment"># eslint 模板</span>
│  │  ├─router <span class="token comment"># vue-router 模板</span>
│  │  ├─vue <span class="token comment"># vue 模板</span>
│  │  ├─vuex <span class="token comment"># vuex 模板</span>
│  │  └─webpack <span class="token comment"># webpack 模板</span>
</code></pre></div><p>每个功能的文件其实就是两个作用</p> <ol><li>给<code>pkg</code>注入该功能的依赖项</li> <li>提供这个功能在我们项目中的生成的模板文件 —— 比如创建一个<code>vue</code>项目，会自动生成<code>vue</code>的一套模板文件</li></ol> <h4 id="先分析注入依赖"><a href="#先分析注入依赖" class="header-anchor">#</a> 先分析注入依赖</h4> <p>既然我们现在是要生成内容，所以我们定义了一个<code>Generator</code>类来帮我们干这个活</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Generator.js</span>
<span class="token keyword">class</span> <span class="token class-name">Generator</span><span class="token punctuation">{</span>
	<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>拿<code>babel</code>这个功能举例，<code>babel</code>的代码如下（<code>babel</code>是一个将代码向后兼容的一个工具，所以它没有渲染模板这个部分😋）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// /babel/index.js</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">generator</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  generator<span class="token punctuation">.</span><span class="token function">extendPackage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">babel</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">dependencies</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;core-js&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.8.3&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">devDependencies</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;@babel/core&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.12.13&quot;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;@babel/preset-env&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.12.13&quot;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;babel-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^8.2.2&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>可以看到，在<strong>注入依赖</strong>这个环节，是利用了<code>Generator</code>的 <code>extendPackage</code> 方法来实现的👇</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Generator.js</span>
  <span class="token function">extendPackage</span><span class="token punctuation">(</span><span class="token parameter">fields</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> pkg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pkg<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> fields<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 拿到传入功能模板key的值</span>
      <span class="token keyword">const</span> value <span class="token operator">=</span> fields<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">// 拿到现有的pkg对应key的值</span>
      <span class="token keyword">const</span> existing <span class="token operator">=</span> pkg<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">// 如果是这三个属性</span>
      <span class="token comment">// 就要添加当前的value到现有对象上 —— Object.assign</span>
      <span class="token comment">// 不是这三个属性就直接覆盖修改</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>
        <span class="token function">isObject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">&quot;dependencies&quot;</span> <span class="token operator">||</span>
          key <span class="token operator">===</span> <span class="token string">&quot;devDependencies&quot;</span> <span class="token operator">||</span>
          key <span class="token operator">===</span> <span class="token string">&quot;scripts&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        pkg<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>existing <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        pkg<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><p><strong>注入babel的依赖之后</strong>，此时的<code>pkg</code>就变成了👇</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token literal-property property">pkg</span><span class="token operator">:</span>  <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
  <span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token string">'0.1.0'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dependencies</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">'core-js'</span><span class="token operator">:</span> <span class="token string">'^3.8.3'</span> <span class="token punctuation">}</span>
<span class="token punctuation">,</span>
  <span class="token literal-property property">devDependencies</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'@babel/core'</span><span class="token operator">:</span> <span class="token string">'^7.12.13'</span><span class="token punctuation">,</span>
    <span class="token string-property property">'@babel/preset-env'</span><span class="token operator">:</span> <span class="token string">'^7.12.13'</span><span class="token punctuation">,</span>
    <span class="token string-property property">'babel-loader'</span><span class="token operator">:</span> <span class="token string">'^8.2.2'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">babel</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span> '@babel<span class="token operator">/</span>preset<span class="token operator">-</span>en
v' <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其他的功能也是这个流程，都是调用<code>Generator</code>的 <code>extendPackage</code> 来实现的💪</p> <h4 id="再渲染模板"><a href="#再渲染模板" class="header-anchor">#</a> 再渲染模板</h4> <p>拿<code>vuex</code>这个功能模块举例👇</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// vuex/index.js</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">generator</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 调用generator的injectImports方法</span>
  <span class="token comment">// 给项目的入口文件 -&gt; &quot;src/man.js&quot; 注入代码 -&gt; &quot;import store from './store&quot;</span>
  generator<span class="token punctuation">.</span><span class="token function">injectImports</span><span class="token punctuation">(</span>generator<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">import store from './store'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 给项目的入口文件 -&gt; &quot;src/man.js&quot; 的 new Vue() 注入选项 store</span>
  generator<span class="token punctuation">.</span><span class="token function">injectRootOptions</span><span class="token punctuation">(</span>generator<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">store</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 注入依赖</span>
  generator<span class="token punctuation">.</span><span class="token function">extendPackage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">dependencies</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">vuex</span><span class="token operator">:</span> <span class="token string">&quot;^3.6.2&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 渲染功能文件中的template，也就是模板内容</span>
  generator<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">&quot;./template&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><code>vuex</code>这个功能模块需要渲染模板代码，它的模板代码就放在<code>vuex/template</code>中👇</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// template/index.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">&quot;vuex&quot;</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mutations</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">actions</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在使用脚手架创建<code>vue</code>项目时，如果你没有添加<code>vuex</code>这个功能，那<code>src/main.js</code>的内容是下面这个样子（应该非常熟悉吧😏）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&quot;./App.vue&quot;</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果你选了<code>vuex</code>这个功能，那脚手架就会把<code>vuex/template/index.js</code>里的内容给<strong>注入</strong>里面</p> <p>这个功能的实现就是通过上面的<code>injectImports</code>和<code>injectRootOptions</code>方法☝️</p> <blockquote><p>细节就不阐述了，参考源代码即可</p></blockquote> <div class="custom-block tip"><p class="title"></p><p><strong>模板代码注入</strong>的逻辑大致如下</p> <ul><li>使用 <code>vue-codemod</code> 将代码解析成语法抽象树 <code>AST</code></li> <li>然后将要插入的代码变成 <code>AST</code> 节点插入到语法抽象树中</li> <li>最后将新的 <code>AST</code> 重新渲染成代码</li></ul></div><h3 id="生成文件"><a href="#生成文件" class="header-anchor">#</a> <strong>生成文件</strong></h3> <p>在完成上面👇的依赖和模板代码注入之后，这些内容目前还只存在内存中，比如<code>package.json</code>的内容，还在<code>pkg</code>这个变量里面，而无论是<code>package.json</code>还是模板代码，最后都是要生成文件显示的，所以这一步我们就要开始<strong>生成这些文件</strong>了</p> <p>写了一个生成文件的函数👇</p> <blockquote><p>借用了<code>fs</code>的<code>writeFileSync</code>同步写入文件的函数来实现</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs-extra'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">writeFileTree</span><span class="token punctuation">(</span><span class="token parameter">dir<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 遍历每个功能文件</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span> name<span class="token punctuation">)</span>
        <span class="token comment">// ensureDir()的同步版本</span>
        <span class="token comment">// 确保目录存在，如果目录结构不存在，则由该函数创建</span>
        fs<span class="token punctuation">.</span><span class="token function">ensureDirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">)</span>
        fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> files<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>☝️逻辑如下：</p> <ul><li>遍历所有渲染好的模板文件，按顺序生成</li> <li>在生成文件前，先判断一下父目录是不是存在，如果不存在，就先生成父目录</li> <li>生成并写入文件</li></ul> <p>比如现在一个模板文件要写到 <code>src/test.js</code>，第一次写入时，由于还没有 <code>src</code> 目录。所以会先生成 <code>src</code> 目录，再生成 <code>test.js</code> 文件</p> <p>生成文件的代码肯定也是<code>Generator</code>这个类的函数方法了，<strong>生成文件</strong>功能(<code>generate</code>)代码如下:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">async</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token comment">// 生成 package.json</span>
    <span class="token comment">// 从 package.json 中提取文件 —— 比如babel的内容，提取成babel.config.js</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">extractConfigFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 解析模板文件内容</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resolveFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将 package.json 中的字段排序</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sortPkg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">&quot;package.json&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pkg<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 将package.json和所有模板文件写入到用户要创建的目录</span>
    <span class="token keyword">await</span> <span class="token function">writeFileTree</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>files<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><h2 id="下载依赖"><a href="#下载依赖" class="header-anchor">#</a> 下载依赖</h2> <p>在我们生成文件之后，模板文件的工作就结束了，但是我们的依赖此时并没有安装，只是存在了<code>package.json</code>里的字段中，用户还得自己安，我们既然是个脚手架，就要尽可能的减少用户的操作，所以，在<code>create</code>时，我们直接帮用户把依赖也安装了~</p> <p>写了一个下载依赖的函数👇</p> <div class="custom-block tip"><p class="title"></p><p>利用了 <a href="https://github.com/sindresorhus/execa" target="_blank" rel="noopener noreferrer">execa<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 这个库 —— 利用它来调用子进程执行命令</p></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> execa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'execa'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">executeCommand</span><span class="token punctuation">(</span><span class="token parameter">command<span class="token punctuation">,</span> cwd</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> child <span class="token operator">=</span> <span class="token function">execa</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            cwd<span class="token punctuation">,</span>
            <span class="token literal-property property">stdio</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'inherit'</span><span class="token punctuation">,</span> <span class="token string">'pipe'</span><span class="token punctuation">,</span> <span class="token string">'inherit'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        child<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token parameter">buffer</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        child<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token parameter">code</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">command failed: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>command<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span>
            <span class="token punctuation">}</span>

            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在<code>create.js</code> 里调用</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// create.js 文件</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'\n正在下载依赖...\n'</span><span class="token punctuation">)</span>
<span class="token comment">// 下载依赖</span>
<span class="token keyword">await</span> <span class="token function">executeCommand</span><span class="token punctuation">(</span><span class="token string">'yarn add'</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'\n依赖下载完成! 你可以执行下列命令开始开发：\n'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">cd </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">yarn dev</span><span class="token template-punctuation string">`</span></span>
</code></pre></div><p>逻辑很简单，这里为了让用户看到下载依赖的过程，使用下面的代码将子进程的输出传给主进程，也就是输出到控制台👇</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>child<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token parameter">buffer</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block danger"><p class="title"></p><p>报错: <code>unable to resolve dependency tree</code></p> <p>原因: 依赖之间版本不对应 —— 比如<code>vue3</code>要对应<code>vuex4</code></p></div></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/blogs/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91.html#什么是脚手架" class="sidebar-link reco-side-什么是脚手架" data-v-b57cc07c>❓ 什么是脚手架</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91.html#准备工作" class="sidebar-link reco-side-准备工作" data-v-b57cc07c>准备工作</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91.html#项目目录" class="sidebar-link reco-side-项目目录" data-v-b57cc07c>项目目录</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91.html#开始开发" class="sidebar-link reco-side-开始开发" data-v-b57cc07c>开始开发</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91.html#最后一次开发前的准备" class="sidebar-link reco-side-最后一次开发前的准备" data-v-b57cc07c>最后一次开发前的准备</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91.html#处理用户命令" class="sidebar-link reco-side-处理用户命令" data-v-b57cc07c>处理用户命令</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91.html#与用户交互" class="sidebar-link reco-side-与用户交互" data-v-b57cc07c>与用户交互</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91.html#项目模板" class="sidebar-link reco-side-项目模板" data-v-b57cc07c>项目模板</a></li><li class="level-3" data-v-b57cc07c><a href="/blogs/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91.html#生成文件" class="sidebar-link reco-side-生成文件" data-v-b57cc07c>生成文件</a></li><li class="level-2" data-v-b57cc07c><a href="/blogs/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91.html#下载依赖" class="sidebar-link reco-side-下载依赖" data-v-b57cc07c>下载依赖</a></li></ul></div></div></div><div class="global-ui"><!----><!----><!----><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      欢迎来到 Seb's Blog
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:none;" data-v-5775ee02></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="https://raw.githubusercontent.com/bhdgogogo/cloud-img/img/blogImg/1.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:200px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="https://raw.githubusercontent.com/bhdgogogo/cloud-img/img/blogImg/20230703193639.png" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(https://raw.githubusercontent.com/bhdgogogo/cloud-img/img/blogImg/20230703193639.png);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>How to love</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>Lil Wayne</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div></div></div>
    <script src="/assets/js/app.a113d251.js" defer></script><script src="/assets/js/3.4a4413e0.js" defer></script><script src="/assets/js/1.8710bd02.js" defer></script><script src="/assets/js/32.85e312a4.js" defer></script>
  </body>
</html>
